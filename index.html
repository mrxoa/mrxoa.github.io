<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Hello, world!</title>
    <style media="screen">
      th { text-align: center; vertical-align: middle; }
      td { text-align: right; vertical-align: middle; }
    </style>
  </head>
  <body>
    <div class="row">
      <div class="col-md-8 offset-md-2">
        <canvas id="meChart" width="100%" height=""></canvas>
        <div class="table-responsive">
          <table class="table table-bordered table-striped table-hover table-sm">
            <thead>
              <tr>
                <th>#</th> <th>XR</th>
                <th>01</th> <th>02</th> <th>03</th> <th>04</th> <th>05</th> <th>06</th> <th>07</th> <th>08</th> <th>09</th> <th>10</th> <th>11</th> <th>12</th>
                <th>XT</th> <th>XP</th>
              </tr>
            </thead>
            <tbody id="list">
              <tr>
                <th>2017</th> <td>{{ xr2017 | formatNumber }}</td>
                <td v-for="row in r2017">
                  <span v-if="row >= xr2017">
                      <span v-if="row == m2017"> <span class="text-success"> {{ parseInt(row) | formatNumber }} </span>   </span>
                      <span v-else> <span class="text-primary"> {{ parseInt(row) | formatNumber }} </span>   </span>
                  </span>
                  <span v-else>
                    <span v-if="row == n2017"> <span class="text-danger"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-warning"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                </td>
                <td>{{ t2017 | formatNumber }}</td> <td>{{ (t2017/tdata)*100 | formatPersent }}</td>
              </tr>
              <tr>
                <th>2018</th> <td>{{ xr2018 | formatNumber }}</td>
                <td v-for="row in r2018">
                  <span v-if="row >= xr2018">
                    <span v-if="row == m2018"> <span class="text-success"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-primary"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                  <span v-else>
                    <span v-if="row == n2018"> <span class="text-danger"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-warning"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                </td>
                <td>{{ t2018 | formatNumber }}</td> <td>{{ (t2018/tdata)*100 | formatPersent }}</td>
              </tr>
              <tr>
                <th>2019</th> <td>{{ xr2019 | formatNumber }}</td>
                <td v-for="row in r2019">
                  <span v-if="row >= xr2019">
                    <span v-if="row == m2019"> <span class="text-success"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-primary"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                  <span v-else>
                    <span v-if="row == n2019"> <span class="text-danger"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-warning"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                </td>
                <td>{{ t2019 | formatNumber }}</td> <td>{{ (t2019/tdata)*100 | formatPersent }}</td>
              </tr>
              <tr>
                <th>2020</th> <td>{{ xr2020 | formatNumber }}</td>
                <td v-for="row in r2020">
                  <span v-if="row >= xr2020">
                    <span v-if="row == m2020"> <span class="text-success"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-primary"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                  <span v-else>
                    <span v-if="row == n2020"> <span class="text-danger"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-warning"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                </td>
                <td>{{ t2020 | formatNumber }}</td> <td>{{ (t2020/tdata)*100 | formatPersent }}</td>
              </tr>
              <tr>
                <th>2021</th> <td>{{ xr2021 | formatNumber }}</td>
                <td v-for="row in r2021">
                  <span v-if="row >= xr2021">
                    <span v-if="row == m2021"> <span class="text-success"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-primary"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                  <span v-else>
                    <span v-if="row == n2021"> <span class="text-danger"> {{ parseInt(row) | formatNumber }} </span> </span>
                    <span v-else> <span class="text-warning"> {{ parseInt(row) | formatNumber }} </span> </span>
                  </span>
                </td>
                <td>{{ t2021 | formatNumber }}</td> <td>{{ (t2021/tdata)*100 | formatPersent }}</td>
              </tr>
              <tr>
                <td colspan="14" class="text-right">Total</td>
                <td>{{ tdata | formatNumber }}</td>
                <td class="text-danger">{{ 100-((tdata/tg)*100) | formatPersent }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script>
    var data0 = [0,   0,   2970.000,   220.000,   100.000,   0,   200.000,   1860.000,   0,   0,   3200.000,   300.000];
    var data1 = [ 9950.000, 21454.604, 18135.940, 10280.000, 8305.000, 12200.000, 13625.000, 22210.000, 4992.000, 33120.484, 36016.606, 27200.000];
    var data2 = [ 10200.000, 12687.390, 7287.000, 33593.440, 20476.500, 30034.000, 21450.338, 15198.500, 14752.655, 19435.742, 11008.085, 36267.535];
    var data3 = [ 25156.993, 50755.340, 28840.099, 17333.993, 30022.179, 37723.217, 90650+4713.192+750+150+100, 4284.720+775+550+150+100, 2356.596+775+550+150, 2716.871+775+550+150, 15000+775+550+150, 775+550+150];
    var data4 = [ 775+150, 775, 775, 775, 775, 775, 775, 775, 25, 0, 0, 0 ];
    var ctxme = document.getElementById('meChart').getContext('2d');
    var typeme = ['line', 'line', 'line', 'bar', 'bar'];
    var meChart = new Chart(ctxme, {
      type: 'bar',
      data: {
        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
        datasets: [
          { type: typeme[0], lineTension: 0, label: 'Revenue 2017', data: data0, backgroundColor: 'rgba(255, 99, 132, 0.2)', borderColor: 'rgba(255, 99, 132, 1)', borderWidth: 1, fill: false, },
          { type: typeme[1], lineTension: 0, label: 'Revenue 2018', data: data1, backgroundColor: 'rgba(54, 162, 235, 0.2)', borderColor: 'rgba(54, 162, 235, 1)', borderWidth: 1, fill: false, },
          { type: typeme[2], lineTension: 0, label: 'Revenue 2019', data: data2, backgroundColor: 'rgba(255, 206, 86, 0.2)', borderColor: 'rgba(255, 206, 86, 1)', borderWidth: 1, fill: false, },
          { type: typeme[3], lineTension: 0, label: 'Revenue 2020', data: data3, backgroundColor: 'rgba(75, 192, 192, 0.2)', borderColor: 'rgba(75, 192, 192, 1)', borderWidth: 1, fill: false, },
          { type: typeme[4], lineTension: 0, label: 'Revenue 2021', data: data4, backgroundColor: 'rgba(153, 102, 255, 0.2)', borderColor: 'rgba(153, 102, 255, 1)', borderWidth: 1, fill: false, },
        ],
      },
      options: {
        responsive: true, legend: { position: 'bottom', },
        title: { display: true, text: 'Money Report A', position: 'top' },
        tooltips: { mode: 'index', intersect: false, }, hover: { mode: 'nearest', intersect: true, },
        scales: {
          xAxes: [{ display: true, scaleLabel: { display: false, labelString: 'Month' } }],
          yAxes: [{
            display: true, scaleLabel: { display: false, labelString: 'Value' },
            // ticks: { min: -1000, max: 100, forces step size to be 5 units stepSize: 1750 },
          }]
        }
      }
    });
    const arrSum = arr => arr.reduce((a,b) => a + b, 0)
    var list = new Vue({ el: '#list',
      data: {
        r2017 : data0, r2018 : data1, r2019 : data2, r2020 : data3, r2021 : data4,
        t2017 : arrSum(data0), t2018 : arrSum(data1), t2019 : arrSum(data2), t2020 : arrSum(data3), t2021 : arrSum(data4),
        xr2017 : arrSum(data0)/12, xr2018 : arrSum(data1)/12, xr2019 : arrSum(data2)/12, xr2020 : arrSum(data3)/12, xr2021 : arrSum(data4)/12,
        tdata : arrSum(data0)+arrSum(data1)+arrSum(data2)+arrSum(data3)+arrSum(data4),
        m2017 : Math.max.apply(Math, data0), m2018 : Math.max.apply(Math, data1), m2019 : Math.max.apply(Math, data2), m2020 : Math.max.apply(Math, data3), m2021 : Math.max.apply(Math, data4),
        n2017 : Math.min.apply(Math, data0), n2018 : Math.min.apply(Math, data1), n2019 : Math.min.apply(Math, data2), n2020 : Math.min.apply(Math, data3), n2021 : Math.min.apply(Math, data4),
        tg : 1000000,
      },
      filters: { formatNumber: function (value) { return numeral(value).format("0,0"); }, formatPersent: function (value) { return numeral(value).format('0,0.00'); } }
    });
    </script>
  </body>
</html>
